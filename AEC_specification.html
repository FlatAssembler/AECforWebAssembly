<html lang="en">
  <head>
    <title>AEC Language Specification</title>
    <style type="text/css">
      title {
        font-family: "Courier New", monospace;
      }
      body {
        background-image: url("background.jpg");
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: cover;
      }
      header {
        height: 200px;
        line-height: 200px;
        text-align: center;
        color: darkblue;
        font-weight: bold;
        font-size: 36px;
        font-family: Lucida;
      }
      aside {
        width: 25%;
        background: #aaaaff;
        height: 100%;
        float: left;
        color: #aa4400;
        overflow: auto;
      }
      aside a {
        text-decoration: none;
      }
      section {
        width: 25%;
        background: #ffffaa;
        height: 100%;
        float: right;
        color: purple;
        text-align: center;
        overflow: auto;
      }
      .main1 {
        background: black;
        color: darkgray;
        width: 50%;
        height: 100%;
        overflow: auto;
        font-family: Verdana;
      }
      .main1 table,
      .main1 th,
      .main1 td {
        color: darkgray;
        border: 1px solid darkgray;
      }
      .main1 a {
        color: lightgreen;
      }
      .main2 {
        background: black;
        color: lightgreen;
        width: 50%;
        height: 100%;
        overflow: auto;
      }
      .main2 table,
      .main2 th,
      .main2 td {
        border: 1px solid lightgreen;
        color: lightgreen;
      }
      .main2 a {
        color: #00ffff;
      }
      .main3 {
        background: #eeeeee;
        color: #333333;
        width: 50%;
        height: 100%;
        overflow: auto;
        font-family: Arial;
      }
      .main3 a {
        color: #00aaaa;
      }
      .main3 table,
      .main3 th,
      .main3 td {
        border: 1px solid #333333;
        color: #333333;
      }
      .link1 {
        text-decoration: none;
        background: linear-gradient(to right, #111111, #333333);
        height: 30px;
        width: 100%;
        color: #ff3300;
        line-height: 30px;
        text-indent: 10px;
        font-family: Verdana;
        text-indent: 5px;
      }
      .popup {
        display: none;
        background: black;
        font-size: 14px;
        line-height: 18px;
        color: white;
        opacity: 0.75;
        position: absolute;
        left: 25%;
        border-width: 7px;
        border-style: solid;
        border-color: black;
        max-width: 200px;
        text-indent: 0px;
      }
      .popup::before {
        content: " ";
      }
      .link1:hover {
        background: darkGray;
        color: black;
      }
      .link1:hover .popup {
        display: block;
      }
      .link2 {
        background: linear-gradient(to right, #333333, #111111);
        color: #ff3300;
      }
      footer {
        width: 100%;
        height: 50px;
        /*background: #aaffaa;*/
        text-align: center;
        color: #007777;
        line-height: 50px;
      }
      pre {
        overflow: scroll;
        color: lightGreen;
        font-size: 1em;
        font-family: "Lucida Console", "Courier New", Courier, monospace;
        background: #111111;
        text-align: left;
        margin-top: 3px;
        margin-bottom: 3px;
        padding: 3px;
      }
      .inline_code {
        font-family: "Lucida Console", "Courier New", Courier, monospace;
        font-weight: bold;
        font-style: normal;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      .quotation {
        margin-top: 5px;
        margin-bottom: 5px;
        display: block;
        font-family: Times;
        padding-left: 10px;
        padding-right: 10px;
        padding-bottom: 5px;
        padding-top: 5px;
        background: #ffffdd;
        color: black;
      }
      .quotation .quotation {
        background: #cccc00;
      }
      .quotation .quotation .quotation {
        background: #aaaa00;
      }
      .formula {
        background: white;
        color: black;
        font-family: Times;
        padding: 3px;
        margin-top: 3px;
        margin-bottom: 3px;
        text-align: center;
        white-space: nowrap;
        overflow-x: scroll;
      }
      /* Generated by VIM */
      .Constant {
        font-weight: bold;
        color: #ffa0a0;
      }
      .Statement {
        color: #f0e68c;
        font-weight: bold;
      }
      .Type {
        color: #bdb76b;
        font-weight: bold;
      }
      .Comment {
        font-weight: bold;
        color: #eeffff;
      }
      .Keyword {
        font-weight: bold;
        color: #ffccaa;
      }
      .Operator {
        font-weight: bold;
        color: #ffaaff;
      }
      .String {
        color: #ffaa77;
      }
      .Parenthesis {
        color: #aaaaff;
        font-weight: bold;
      }
      /* Generated by Notepad++ */
      .sc2 {
        color: #ff8000;
      }
      .sc4 {
        font-weight: bold;
        color: #ffff80;
      }
      .sc6 {
        font-weight: bold;
        color: #4040ff;
      }
      .sc8 {
        font-weight: bold;
        color: #8080ff;
      }
      .sc9 {
        font-weight: bold;
        color: #ff7777;
      }
    </style>
  </head>
  <body>
    <noscript>
      <img
        src="gornjiLijevi.svg"
        style="
          position: absolute;
          left: 8px;
          width: 25%;
          height: 200px;
          top: 8px;
          -webkit-animation-name: animacija;
          -webkit-animation-duration: 2s;
        "
      />
      <img
        src="gornjiDesni.svg"
        style="
          position: absolute;
          width: 25%;
          height: 200px;
          left: -webkit-calc(75% - 8px);
          left: calc(75% - 8px);
          top: 8px;
          -webkit-animation-name: animacija;
          -webkit-animation-duration: 2s;
        "
      />
      <img
        src="donjiLijevi.svg"
        style="
          position: absolute;
          width: 25%;
          height: 50px;
          left: 8px;
          top: calc(100% + 200px - 8px);
          top: -webkit-calc(100% + 200px - 8px);
          -webkit-animation-name: animacija;
          -webkit-animation-duration: 2s;
        "
      />
      <div
        style="
          position: absolute;
          top: -webkit-calc(100% + 200px + 50px + 8px);
          top: calc(100% + 200px + 50px + 8px);
          width: 100%;
          height: 50px;
          font-size: 36px;
          font-family: Arial;
          text-align: center;
          background: #333333;
          color: #aaaaaa;
          line-height: 50px;
        "
      >
        Please enable JavaScript!
      </div>
    </noscript>
    <header>
      <svg
        id="gornjiLijevi"
        style="overflow: hidden; float: left; width: 25%; height: 200px"
      ></svg>
      <svg
        id="gornjiDesni"
        style="overflow: hidden; float: right; width: 25%; height: 200px"
      ></svg>
      <div
        style="background: #ffaaaa; float: right; width: 50%; height: 100%"
        id="naslov"
      >
        <div
          style="position: relative; top: 50%; transform: translate(0, -50%)"
          id="titleContainer"
        >
          AEC specification
        </div>
      </div>
      <script type="text/javascript">
        var svgNS = "http://www.w3.org/2000/svg";
        function nacrtajRubove() {
          var crtanje = document.getElementById("gornjiLijevi");
          while (crtanje.childNodes.length)
            crtanje.removeChild(crtanje.childNodes[0]);
          var visina = crtanje.clientHeight;
          var sirina = crtanje.clientWidth;
          if (!visina || !sirina) {
            visina = crtanje.parentNode.clientHeight;
            sirina = crtanje.parentNode.clientWidth / 4;
          }
          var elipsa = document.createElementNS(svgNS, "ellipse");
          elipsa.setAttribute("cx", sirina);
          elipsa.setAttribute("cy", visina);
          elipsa.setAttribute("rx", sirina);
          elipsa.setAttribute("ry", visina);
          elipsa.setAttribute("fill", "#ffaaff");
          crtanje.appendChild(elipsa);
          for (var i = 0; i < 30; i++) {
            var kut1 = (270 + i * 3) / 57.3;
            var kut2 = (274 + i * 3) / 57.3;
            var x1 = Math.round(sirina - Math.cos(kut1) * sirina);
            var x2 = Math.round(sirina - Math.cos(kut2) * sirina);
            var y1 = Math.round(visina + Math.sin(kut1) * visina);
            var y2 = Math.round(visina + Math.sin(kut2) * visina);
            var trokut = document.createElementNS(svgNS, "polygon");
            trokut.setAttribute(
              "points",
              x1 + "," + y1 + " " + x2 + "," + y2 + " " + sirina + "," + visina
            );
            trokut.setAttribute(
              "fill",
              "rgb(" +
                Math.round(255 - i * 2.83) +
                ",170," +
                Math.round(170 + i * 2.83) +
                ")"
            );
            crtanje.appendChild(trokut);
          }
          crtanje = document.getElementById("gornjiDesni");
          while (crtanje.childNodes.length)
            crtanje.removeChild(crtanje.childNodes[0]);
          var elipsa = document.createElementNS(svgNS, "ellipse");
          elipsa.setAttribute("cx", 0);
          elipsa.setAttribute("cy", visina);
          elipsa.setAttribute("rx", sirina);
          elipsa.setAttribute("ry", visina);
          elipsa.setAttribute("fill", "#ffffaa");
          crtanje.appendChild(elipsa);
          for (var i = 0; i < 30; i++) {
            var kut1 = (i * 3) / 57.3;
            var kut2 = (4 + i * 3) / 57.3;
            var x1 = Math.round(Math.cos(kut1) * sirina);
            var x2 = Math.round(Math.cos(kut2) * sirina);
            var y1 = Math.round(visina - Math.sin(kut1) * visina);
            var y2 = Math.round(visina - Math.sin(kut2) * visina);
            var trokut = document.createElementNS(svgNS, "polygon");
            trokut.setAttribute(
              "points",
              x1 + "," + y1 + " " + x2 + "," + y2 + " 0," + visina
            );
            trokut.setAttribute(
              "fill",
              "rgb(255," + Math.round(255 - i * 2.83) + ",170)"
            );
            crtanje.appendChild(trokut);
          }
        }
        nacrtajRubove();
        window.addEventListener("resize", nacrtajRubove);
      </script>
    </header>
    <aside>
      <br />
      <center><b>Here are my online publications:</b></center>
      <br />
      <b style="margin-left: 5px">HTML5 stuff:</b>
      <a href="sat.html"
        ><div class="link1">
          <div class="popup">
            A simple "grandfather clock" animation made in Javascript.
          </div>
          Analog Clock
        </div></a
      >
      <a href="calculator.html"
        ><div class="link2 link1">
          <div class="popup">
            A simple HTML5 online calculator. Can solve parentheses!
          </div>
          Calculator
        </div></a
      >
      <a href="fraktal.html"
        ><div class="link1">
          <div class="popup">
            A spiral fractal I've made by modifying the "Dragon Curve".
          </div>
          The Dragon Curve
        </div></a
      >
      <a href="pacman.html"
        ><div class="link2 link1">
          <div class="popup">
            A Pacman game playable on touch screens. Made in Javascript using
            the SVG graphics.
          </div>
          PacMan
        </div></a
      >
      <a href="etymologist.html">
        <div class="link1">
          <div class="popup">
            A flashcard game in which the goal is to guess the etymologies of
            the words in simulated languages.
          </div>
          Etymology Game
        </div></a
      >
      <br /><b style="margin-left: 5px">Webpages on this website:</b>
      <a href="index.html"
        ><div class="link1">
          <div class="popup">A webpage with a bunch of links.</div>
          Homepage
        </div></a
      >
      <a href="libertarianism.html"
        ><div class="link2 link1">
          <div class="popup">What do I think about politics?</div>
          Libertarianism
        </div></a
      >
      <a href="vegetarianism.html"
        ><div class="link1">
          <div class="popup">Why I don't eat meat.</div>
          Vegetarianism
        </div></a
      >
      <a href="Simulation.html"
        ><div class="link2 link1">
          <div class="popup">Could the universe be a giant computer?</div>
          Digital Physics
        </div></a
      >
      <a href="linguistics.html"
        ><div class="link1">
          <div class="popup">
            Why I like languages.<br /><br />
            See also:<br />
            <u
              style="color: #0077ff"
              onclick="window.open('http://flatassembler.github.io/toponyms.html'); window.close();"
              >Croatian Toponyms</u
            ><br />
            <u
              style="color: #0077ff"
              onclick="window.open('http://flatassembler.github.io/Indo-Austronesian.html'); window.close();"
              >Indo-Austronesian</u
            >
          </div>
          Linguistics
        </div></a
      >
      <a href="informatics.html"
        ><div class="link2 link1">
          <div class="popup">The webpage you are currently browsing.</div>
          Informatics
        </div></a
      >
      <a href="pseudosciences.html"
        ><div class="link1">
          <div class="popup">
            My advice on how to recognize and deal with false sciences.
          </div>
          Pseudosciences
        </div></a
      >
      <br /><b style="margin-left: 5px">On Internet forums and blogs:</b>
      <a href="http://linguistforum.com/outside-of-the-box/croatian-toponyms/"
        ><div class="link1">
          <div class="popup">
            The forum thread in which I explained my linguistic theories in
            detail.
          </div>
          Croatian Toponyms
        </div></a
      >
      <a href="https://atheistforums.org/thread-50241.html"
        ><div class="link2 link1">
          <div class="popup">My parody of the conspiracy theorists.</div>
          Airplanes Don't Exist
        </div></a
      >
    </aside>
    <section>
      <p style="margin-left: 5px; margin-right: 5px">
        <br />
        I've started a discussion about AEC
        <a href="https://www.forum.hr/showthread.php?t=1125353">on</a>
        <a href="https://atheistforums.org/thread-57848.html">many</a>
        <a href="https://philosophicalvegan.com/viewtopic.php?f=15&t=4429"
          >Internet</a
        >
        <a
          href="https://www.theflatearthsociety.org/forum/index.php?topic=85381.0"
          >forums</a
        >, including
        <a
          href="https://www.reddit.com/r/ProgrammingLanguages/comments/iehbmj/my_programming_language_can_now_run_in_a_browser/?utm_source=share&utm_medium=web2x&context=3"
          >Reddit</a
        >. <br />
      </p>
      <br />
      <a id="loptica" href="#vrh" style="position: absolute">
        <svg width="100" height="100">
          <defs>
            <radialgradient id="modrozelen">
              <stop offset="0%" stop-color="#00FFFF" />
              <stop offset="100%" stop-color="#0000FF" />
            </radialgradient>
            <radialgradient id="ljubicastoplav">
              <stop offset="0%" stop-color="#FF00FF" />
              <stop offset="100%" stop-color="#0000FF" />
            </radialgradient>
          </defs>
          <circle cx="50" cy="50" r="50" fill="url(#modrozelen)" />
          <polygon
            points="50,25 25,50 38,50 38,75 62,75 62,50 75,50"
            fill="url(#ljubicastoplav)"
          />
        </svg>
      </a>
      <script type="text/javascript">
        var udaraca = 0;
        var loptica = document.getElementById("loptica");
        var pocetna = loptica.parentNode.clientHeight + 200 - 100;
        loptica.style.top = pocetna;
        loptica.style.right = loptica.parentNode.clientWidth / 2 - 50;
        var h = 0;
        var gk = 1;
        var v = 10;
        window.setInterval(pomakniLopticu, 80);
        window.addEventListener("resize", promijeniPocetnu);
        function promijeniPocetnu() {
          pocetna = loptica.parentNode.clientHeight + 210 - 100;
          loptica.style.top = pocetna;
          loptica.style.right = loptica.parentNode.clientWidth / 2 - 50;
          h = 0;
          gk = 1;
          v = 10;
        }
        function pomakniLopticu() {
          h += v;
          v -= gk;
          if (h < 0) {
            v = -v * 0.75;
            h = 0;
            udaraca++;
            if (udaraca > 20) {
              udaraca = 0;
              v = 10;
            }
          }
          loptica.style.top = pocetna - h;
        }
      </script>
    </section>
    <main class="main1" id="glavni" style="display: block">
      <a name="vrh"></a>
      <h2 style="text-align: center">AEC Specification</h2>
      <div
        style="
          text-align: justify;
          margin-left: 10px;
          margin-right: 10px;
          margin-bottom: 25px;
        "
      >
        <b>Contents</b><br />
        <ol>
          <li><a href="#Introduction">Introduction</a></li>
          <li><a href="#Platforms">What platforms can be targeted now</a></li>
          <li><a href="#HowToCompile">How to use the compilers</a></li>
          <li><a href="#Comments">Comments</a></li>
          <li><a href="#Constants">Constants</a></li>
          <li><a href="#Variables">Variable declarations</a></li>
          <li><a href="#Arrays">Arrays and pointers</a></li>
          <li><a href="#Assignments">Assignments</a></li>
          <li><a href="#Operators">Operators</a></li>
          <li><a href="#Branching">Branching</a></li>
          <li><a href="#Loops">Loops</a></li>
          <li><a href="#Functions">Functions</a></li>
          <li><a href="#Structures">Structures</a></li>
          <li><a href="#Assembly">Inline assembly</a></li>
          <li><a href="#Builtin">Built-in functions</a></li>
          <li><a href="#String">String manipulation</a></li>
          <li><a href="#AdvancedArray">Advanced array manipulation</a></li>
          <li><a href="#Conclusion">Conclusion</a></li>
        </ol>
        <b id="Introduction">Introduction</b><br />
        Compilers these days, even C compilers, have lots of features and are
        often smarter than the programmer when it comes to things they are made
        to do. While this is usually very useful, sometimes it's
        counter-productive. Suppose that you are writing a program in Assembly
        and want to do something high-level (because correctness is way more
        important than speed). You can't tell your C compiler to simply output
        the code to assign <span class="inline_code">sqrt(a*a+b*b)</span> to
        <span class="inline_code">c</span>, if you try to, it will complain
        those variables aren't declared and that you aren't in a C function. C
        compilers have ideas how to declare functions and variables in assembly.
        While these ideas usually work, sometimes you are writing something
        where the assembler will complain if you give it the code that C
        compilers produced for those things, and there is no way to modify the
        code the C compiler outputs for declaring a function in C. So,
        sometimes, compilers, while they could come useful for some task, are
        trying to do too much and are thus counter-productive. Can we have a
        language with a compiler that does only what you told it, in a very
        predictable way? Well, that's what inspired me to create
        <i>Arithmetic Expression Compiler</i> (AEC) a few years ago.<br />
        <br /><b id="Platforms">What platforms can be targeted now</b><br />
        Right now, I've written two compilers for the AEC language. First, I
        wrote one targeting x86 processors (AMD and Intel). That one is written
        in JavaScript and the <a href="compiler.html">core of it</a> can be run
        in browsers that have basic support for JavaScript (even in Internet
        Explorer 6). To use all the features, one needs to use
        <a href="https://nodejs.org/en/">NodeJS</a> or
        <a href="https://duktape.org/">Duktape</a> with it, to enable it to
        access the file system. When I started studying at the university, many
        professors were impressed by that. My Algorithms and Data Structures
        professor Alfonso Baumgartner urged me to write a
        <a
          href="https://github.com/FlatAssembler/ArithmeticExpressionCompiler/raw/master/seminar/PojednostavljeniSeminar.pdf"
        >
          paper</a
        >
        about it which got published in Osje&#269;ki Matemati&#269;ki List. The
        compiler targeting x86 is around 2'000 lines of code (excluding the
        example programs). So, I decided to extend it so that my language can be
        used to target JavaScript Virtual Machine using WebAssembly (the
        JavaScript bytecode, which Mozilla has been pushing to get standardized,
        so that people can run programming languages better than JavaScript in a
        browser), and not only x86. As targeting WebAssembly is easier than
        targeting x86 (or probably any physical processor, as WebAssembly was
        designed to be an easy compilation target, rather than to be easily
        implemented in hardware), I was able to add many new features. However,
        I think it's still not nearly as
        <i>intrusive</i> as C compilers are. Emscripten (the primary C and C++
        compiler for WebAssembly) always assumes the standard C library is
        present on the JavaScript Virtual Machine when compiling any kind of
        program, so it's an overkill for most cases when it could come useful.
        The
        <a href="https://github.com/FlatAssembler/AECforWebAssembly"
          >AEC-to-WebAssembly compiler</a
        >
        has around 5'000 lines of code, and it's written in C++ (a language much
        more suitable for writing compilers than JavaScript). <br />
        <b>UPDATE</b> on 11/10/2020: Of course, my compiler is not a very
        high-quality software. The LGTM static analyzer places it in the
        <a
          href="https://lgtm.com/projects/g/FlatAssembler/AECforWebAssembly/context:cpp"
          ><img
            alt="Language grade: C/C++"
            src="https://img.shields.io/lgtm/grade/cpp/g/FlatAssembler/AECforWebAssembly.svg?logo=lgtm&logoWidth=18"
        /></a>
        category, because it has found
        <a
          href="https://lgtm.com/projects/g/FlatAssembler/AECforWebAssembly/alerts/"
          ><img
            alt="Total alerts"
            src="https://img.shields.io/lgtm/alerts/g/FlatAssembler/AECforWebAssembly.svg?logo=lgtm&logoWidth=18"
        /></a>
        potential bugs per 5'000 lines of code, most of them being unnecessarily
        doing deep copies of C++ objects (wasting time and memory), and quite a
        few of them being using uninitialized variables in JavaScript. If you
        want to collaborate with me, perhaps one of the first things to do is
        fix those bugs found by static analysis. <br /><br />
        <b id="HowToCompile">How to use the compilers</b><br />
        Probably the simplest way to use the AEC-to-x86 compiler on a Linux
        machine is to type the following code into a terminal emulator:
        <pre class="LinuxShell">
mkdir ArithmeticExpressionCompiler
cd ArithmeticExpressionCompiler
wget https://flatassembler.github.io/Duktape.zip
unzip Duktape.zip
gcc -o aec -lm aec.c duktape.c
./aec analogClock.aec
gcc -o analogClock analogClock.s -m32
./analogClock
        </pre>
        If everything is fine, the Analog Clock program should now print the
        current time in the terminal. I think this would work on the vast
        majority of Linux machines, as well as on many non-Linux (FreeBSD,
        Solaris...) machines. A potential problem is that the 32-bit libraries
        are not installed on a 64-bit Linux machine (so that
        <span class="inline_code">-m32</span> fails), but this is rarely the
        case, as Linux machines today usually have
        <a href="https://www.winehq.org/">WINE</a> (a Windows compatibility
        layer requiring 32-bit libraries), or at least some 32-bit programs.
        Needless to say, this will not work on Linux running on ARM processors,
        such as Android or Raspberry Pi. Also, the Analog Clock program probably
        cannot be run on Windows (I haven't managed to try it using
        <a href="https://www.cygwin.com/">CygWin</a>, but I am quite sure it
        wouldn't run on Windows even if I managed to install Cygwin. (<i
          >UPDATE on 08/05/2021: I have found a relatively simple way to modify
          the <span class="inline_code">analogClock.aec</span> so that it can be
          assembled by the version of GNU Assembler that comes with 32-bit
          <a href="https://mingw-w64.org/doku.php">MinGW-W64</a>, and thus run
          on both 32-bit and 64-bit Windows, so I saved it in
          <span class="inline_code">analogClockForWindows.aec</span>.
          Unfortunately, it still shows a lot of errors if you attempt to
          assemble it using the version of GNU Assembler that comes with TDM-GCC
          or CygWin. Apparently, the versions of GNU Assembler that comes with
          various ports of GCC on Windows are different from each other to a
          greater extent than the version of GNU Assembler that runs on Linux
          and one that comes with MinGW-W64 are. I find that both surprising and
          somewhat unfortunate. What is especially unfortunate is the fact that
          <a href="https://stackoverflow.com/a/67451423/8902065"
            >some preprocessor directives in GNU Assembler have the same syntax,
            but different meanings depending on whether it is targetting Linux
            or Windows</a
          >. With a little more modifications, which I have also done,
          <span class="inline_code">analogClockForWindows.aec</span>
          can also be assembled by the version of
          <a href="https://llvm.org/docs/CommandGuide/llvm-as.html"
            >LLVM Assembler</a
          >
          that comes with CLANG on Windows. However, the GNU Assembler that
          comes with MinGW-W64 and the LLVM Assembler that comes with CLANG on
          Windows do not output the same machine code. The executable produced
          by LLVM Assembler appears to run significantly faster on Windows 10,
          but it refuses to run at all on Windows XP. I have not studied it
          enough to explain what is going on there, and it is a bit creepy.</i
        >)), but some other programs in
        <span class="inline_code">Duktape.zip</span> can. However, those cannot
        be assembled by GNU Assembler (invoked by
        <span class="inline_code">gcc</span>), you need to use
        <a href="https://flatassembler.net/">FlatAssembler</a> instead. See the
        <span class="inline_code">ReadMe.html</span> inside
        <span class="inline_code">Duktape.zip</span> for more details. The
        <a
          href="https://github.com/FlatAssembler/ArithmeticExpressionCompiler/raw/master/ArithmeticExpressionCompiler.zip"
          >executables of Duktape for various x86 OS-es and example x86 AEC
          programs</a
        >
        are available in a ZIP archive on my GitHub profile (<i
          >UPDATE on 13/05/2021: Like I have said, the
          <span class="inline_code">analogClockForWindows.exe</span> file,
          assembled by CLANG on Windows, although it works on both 32-bit and
          64-bit Windows 10, for some reason that escapes me, it refuses to run
          on Windows XP. You can assemble the assembly code produced by my
          compiler for the
          <span class="inline_code">analogClockForWindows.aec</span>, which will
          be called <span class="inline_code">analogClockForWindows.s</span>,
          using MinGW-w64, and then it will run on Windows XP, but it will be
          slower. Again, the explanation for that escapes me. An obvious
          explanation would be that MinGW-w64 includes some kind of a polyfill
          for functions missing on Windows XP, that make the executable able to
          run on it, but make it slower. But the problem with that explanation
          is that, actually, the executable produced by CLANG is bigger than the
          executable produced by MinGW-w64. If the executable by MinGW-w64 were
          polyfilled, we would expect it to be bigger, rather than smaller.</i
        >). You can also use
        <a
          href="https://github.com/FlatAssembler/SimpleCalculator/raw/master/SimpleCalculator.zip"
          >SimpleCalculator</a
        >, a version of the AEC-to-x86-compiler running in
        <a href="https://www.mozilla.org/rhino/">Rhino</a> (a JavaScript engine
        written in Java, by Mozilla) and using
        <a href="https://docs.oracle.com/javase/tutorial/uiswing/">Swing GUI</a
        >. It an be used as a simple calculator, but it also supports converting
        AEC programs to x86 assembly. The AEC-to-x86 compiler, both when run in
        Rhino and when run in Duktape, can output assembly in two formats, one
        compatible with FlatAssembler, and one compatible with GNU Assembler. To
        switch between them, use
        <span class="inline_code">syntax fasm</span> and
        <span class="inline_code">syntax gas</span>. By default, it targets
        FlatAssembler. When targeting GNU Assembler, keep in mind that the
        directive <span class="inline_code">syntax gas</span> needs to be the
        very first directive in your program, even before any comments. Namely,
        the AEC-to-x86 compiler passes the comments down to the assembler, but
        FlatAssembler begins comments with <span class="inline_code">;</span>,
        whereas GNU Assembler begins comments with
        <span class="inline_code">#</span>. To GNU Assembler, semi-colon
        <span class="inline_code">;</span> means to have multiple
        assembly-language directives in a single line (useful for when invoked
        from a debugger, where you need to inline a few directives).<br />
        Using the AEC-to-WebAssembly compiler is, on most Linux machines, a
        little trickier. The following code might work:
        <pre class="LinuxShell">
git clone https://github.com/FlatAssembler/AECforWebAssembly.git
cd AECforWebAssembly
g++ -std=c++11 -o aec AECforWebAssembly.cpp
cd analogClock
../aec analogClock.aec
npx -p wabt wat2wasm analogClock.wat
node analogClock
        </pre>
        Again, if everything is fine, the Analog Clock program should print the
        current in the terminal. However, in order for this to work, you need to
        have NodeJS installed, which is often not the case. You also need to
        have a version of NodeJS newer than one which is usually shipped with
        Linux, as Debian-like Linux distributions today usually ship with NodeJS
        10, and CentOS-like distributions with NodeJS 6, and the code my
        compiler generates relies on
        <span class="inline_code">WebAssembly.Global</span> being present, which
        is only true on NodeJS 11 and newer. I think I made the right decision
        not to waste time supporting the earliest implementations of
        WebAssembly, as almost nobody will notice my effort, and I'd need to put
        a lot of it.
        <i
          >Where to draw the line there?
          <span style="font-style: normal"
            ><img
              style="height: 1em"
              src="https://atheistforums.org/images/smilies/huh.gif"
              onerror="this.onerror=function(){this.onerror=null;this.src='https://www.theflatearthsociety.org/forum/Smileys/default/undecided.gif';};this.src='https://philosophicalvegan.com/images/smilies/icon_question.gif'"
              alt="&#10068;&#128580;"
          /></span>
          Make my compiler output <a href="http://asmjs.org/">asm.js</a> as
          well?
          <span style="font-style: normal"
            ><img
              style="height: 1em"
              src="https://atheistforums.org/images/icons/thumbsdown.gif"
              onerror="this.onerror=function(){this.onerror=null;this.src='https://www.theflatearthsociety.org/forum/Smileys/default/angry.gif';};this.src='https://philosophicalvegan.com/images/smilies/icon_rolleyes.gif'"
              alt="&#128078;" /></span
        ></i>
        Of course, in order for
        <span class="inline_code">npx -p wabt wat2wasm</span> to work, you
        either need to have
        <a href="https://www.npmjs.com/package/wabt">WABT</a> already installed,
        or you need to be connected to the Internet so that
        <span class="inline_code">npx</span> can download it (which you probably
        do as you recently cloned from GitHub, but the firewall also needs to
        enable access to <span class="inline_code">npmjs.com</span>, which fewer
        firewalls do). Also, fewer machines have
        <span class="inline_code">git</span> installed than they have
        <span class="inline_code">wget</span> installed, but, if you are a
        programmer, you probably have
        <span class="inline_code">git</span> installed as well. If you want to
        use it on an OS that's not compatible with Linux, well, good luck. I
        have provided some executable files of my compiler for different OS-es
        in case it helps, as the
        <a href="https://github.com/FlatAssembler/AECforWebAssembly/releases"
          >assets to the releases of AECforWebAssembly</a
        >. Especially good luck using WABT there. Sorry, but dealing with binary
        files is complicated, and me building an assembler for WebAssembly into
        my compiler (instead of simply outputting assembly) would give me a lot
        of hassle and very little benefit. I hope you understand.<br /><br />
        <b id="Comments">Comments</b><br />
        In the version of AEC targeting x86, the comments start with
        <span class="inline_code">;</span> and end with a newline character, as
        in FlatAssembler dialect of Assembly (which ArithmeticExpressionCompiler
        primarily targets), and there are no multi-line comments. In the version
        of AEC for WebAssembly, the comments are as in C, C++ and JavaScript,
        single-line comments start with <span class="inline_code">//</span>, and
        multi-line comments start with <span class="inline_code">/*</span> and
        end with <span class="inline_code">*/</span>. Multi-line comments do not
        nest (as they do in, for example, Swift). Many people say multi-line
        comments are a bad thing because bad programmers use them for versioning
        code (which is a very bad practice). I don't think the job of the
        compiler is to enforce some particular programming style and refuse to
        compile code-smelling programs (though warnings are often useful).<br />
        <br /><b id="Constants">Constants</b><br />
        In AEC for x86, a token that consists of numbers and at most one point
        is a number, and all numbers are treated as 32-bit decimal numbers. In
        both dialects of AEC, a string is a token which starts and ends with
        <span class="inline_code">&quot;</span>, and strings are passed
        unchanged to the assembler. String tokens next to each other are
        concatenated by the tokenizer into one string (as in C and C++, in
        contrast with JavaScript). In both dialects of AEC, a token consisting
        of three characters of which both the first one and the last one are
        <span class="inline_code">'</span> is a number, and the tokenizer
        replaces it with a number equal to the ASCII code of the second
        character in that token (like in most dialects of x86 assembly). In AEC
        for WebAssembly, a token which matches the regular expression
        <span class="inline_code">"(^\\d+$)|(^0x(\\d|[a-f]|[A-F])+$)"</span> is
        of type <span class="inline_code">Integer64</span> and is passed
        unchanged to the assembler (notice that this includes hexadecimal
        numbers starting with <span class="inline_code">0x</span>, as in C, C++
        and JavaScript). A token which matches the regular expression
        <span class="inline_code">"^\\d+\\.\\d*$"</span> is of the type
        <span class="inline_code">Decimal64</span> and is also passed unchanged
        to the assembler. Notice that in AEC for WebAssembly,
        <span class="inline_code">3/2=1</span> (as in C and C++), while, in AEC
        for x86, <span class="inline_code">3/2=1.5</span> (as in JavaScript).
        It's hard to tell which approach is better, both can produce
        hard-to-find bugs.<br />
        <br /><b id="Variables">Variable declarations</b><br />
        In the version of AEC targeting x86, there are no variable declarations
        in the language itself, the compiler simply assumes any token that
        matches the regular expression
        <span class="inline_code">"^(_|[A-Z]|[a-z])\\w*\\[?$"</span>
        and is not a keyword is a name of a variable of type 32-bit decimal
        number or 32-bit decimal number array (if it ends with
        <span class="inline_code">[</span>) that's been previously declared in
        assembly. In the version of AEC targeting WebAssembly, variables are
        declared with:
        <pre>DataType name_of_the_variable;</pre>
        Where <span class="inline_code">DataType</span> is
        <span class="inline_code">Character</span>,
        <span class="inline_code">CharacterPointer</span>,
        <span class="inline_code">Integer16</span>,
        <span class="inline_code">Integer16Pointer</span>,
        <span class="inline_code">Integer32</span>,
        <span class="inline_code">Integer32Pointer</span>,
        <span class="inline_code">Decimal32</span>,
        <span class="inline_code">Decimal32Pointer</span>,
        <span class="inline_code">Decimal64</span> or
        <span class="inline_code">Decimal64Pointer</span>. The compiler assumes
        the pointers are 32-bit and characters are 8-bit, which is true in the
        vast majority of cases. There is also a way to initialize a variable:
        <pre>DataType name_of_the_variable := initial_value;</pre>
        Without that, global variables are zero by default, and local variables
        contain whatever happens to be on the top of the system stack at the
        time of their declarations (as in C or C++). In Ada and old versions of
        C, variables must be declared on the top of a scope, before any other
        statement. There is no such restriction in AEC. However, the initial
        values to global variables must be compile-time constants. That means,
        you can't refer to other global variables or to AEC functions. However,
        when writing an initial value for a decimal variable, you can use C
        library (available to the compiler) functions and constants, such as
        <span class="inline_code">sin(x)</span>,
        <span class="inline_code">asin(x)</span>,
        <span class="inline_code">atan2(y,x)</span>,
        <span class="inline_code">pi</span> or
        <span class="inline_code">e</span>. The same doesn't work when assigning
        initial values to local variables. It's possible to declare multiple
        variables of the same type in the same statement by separating them with
        a comma <span class="inline_code">,</span> (as in C, C++ and
        JavaScript). For example (excerpt from the
        <a href="dragonCurve.html">Dragon Curve</a>):
        <pre>
Integer32 directionX[4]    := { 0, 1, 0, -1},
          directionY[4]    := {-1, 0, 1,  0},
          currentX         := 10,
          currentY         := 250 + 490 - 410, //When set on 250, the turtle
                                               //reaches 410 and then turns
                                               //back (I know this by
                                               //experimenting).
          currentDirection := 0,
          lineLength       := 5,
          lineWidth        := 2,
          currentStep      := 0;
        </pre>
        I like the C-like approach to declaring multiple variables in the same
        statement way more than the Ada-and-VHDL-like approach, yet alone the
        Rust-like approach.<br />
        <b>TODO</b>: Decide what to do about aligning the variables in memory
        (making sure that, for example, a
        <span class="inline_code">Integer32</span> is on the memory location
        divisible by 4). Aligning variables wastes memory, sometimes around half
        of the allocated memory ends up unused because of the aligning. On the
        other hand, for the interoperability with other languages, it is
        probably desirable for variables and arrays to be aligned. JavaScript
        throws an exception on attempted unaligned access, while in C and C++,
        it is supported by some compilers and optimization levels but not in
        others (it's undefined behavior). Right now, the AEC compiler doesn't
        make sure the variables are aligned, which I am not sure is the best
        approach. Also, while JavaScript Virtual Machine does allow unaligned
        memory access, it's not guaranteed to be nearly as fast as aligned
        access (on x86, it usually is, on ARM, it's many times slower).<br />
        <br /><b id="Arrays">Arrays and Pointers</b><br />
        Arrays are declared as follows:
        <pre>DataType name_of_the_array[size];</pre>
        They can be initialized as follows:
        <pre>
DataType name_of_the_array[size] := {first_element, second_element...};</pre
        >
        Note that, unlike in C, if you put only one element in the initializer
        list (between <span class="inline_code">{</span> and
        <span class="inline_code">}</span>), only the first element is
        initialized with that value, while others are left uninitialized (or
        are, in the case of global variables, set to zero). Makes a lot more
        sense to me than those complicated rules C and C++ have for initializing
        arrays. In C and C++, you can use array-style syntax with pointers or
        pointer-style syntax with arrays most of the time, except in some
        confusing scenarios. In AEC, you can never do those things. To the AEC
        compiler, the array is named
        <span class="inline_code">name_of_the_array[</span> rather than
        <span class="inline_code">name_of_the_array</span>, and attempting to
        use <span class="inline_code">name_of_the_array</span> to refer to the
        pointer to the first element of the array (as you can usually do in C or
        C++) leads to "undeclared variable" error. This can be confusing to
        those who come from C or C++, but it makes a lot more sense to me. Or,
        you can make it behave in the C-like manner (if it makes your code
        shorter) like this (excerpt from the
        <a href="analogClock.html">Analog Clock in AEC</a>):
        <pre>
    Character signature[100] := {0};
    CharacterPointer signature := AddressOf(signature[0]);
    //AEC, unlike C, always makes a clear distinction between
    //arrays and pointers.
    logString("Empty signature has length of: ");
    logInteger(strlen(signature));
    logString("\n");
    strcat(signature, " Analog Clock for WebAssembly\n");</pre
        >
        To get or assign the value to the thing a pointer points to, you use the
        <span class="inline_code">ValueAt(</span> operator, like this (excerpt
        from
        <a
          href="https://github.com/FlatAssembler/AECforWebAssembly/tree/master/HybridSort"
        >
          HybridSort in AEC </a
        >):
        <pre>
      ValueAt(originalni_niz + donja_granica) :=
                ValueAt(originalni_niz + donja_granica + 1);</pre
        >
        Makes a lot more sense to me than to use the same operator as for the
        multiplication, like C or C++ do (they use
        <span class="inline_code">*</span> for both of those things). To get a
        pointer to something, you use the
        <span class="inline_code">AddressOf(</span> operator. Makes a lot more
        sense to me than the way C and C++ do that, using the same operator as
        for the <i>bitwise and</i> operation (they use
        <span class="inline_code">&amp;</span>). AEC for x86 doesn't support
        pointers at all. Note that, like in C and C++ (but unlike in JavaScript
        or Assembly),
        <span class="inline_code"
          >name_of_some_integer32pointer := name_of_some_integer32pointer +
          1</span
        >
        increases the value stored in it by 4 (the size of
        <span class="inline_code">Integer32</span>), rather than by 1.<br />
        <b>TODO</b>: Implement the multi-dimensional arrays. But let's not use
        the JavaScript-like approach to them, JavaScript really sucks in that
        regard.<br />
        <br /><b id="Assignments">Assignments</b><br />
        For assignments, you use <span class="inline_code">:=</span> operator,
        in both dialects of AEC. In the AEC for WebAssembly, you can nest
        assignment expressions, like this (excerpt from HybridSort):
        <pre>
    broj_obrnuto_poredanih_podniza  :=
        broj_vec_poredanih_podniza  :=
        broj_pokretanja_QuickSorta  :=
        broj_pokretanja_MergeSorta  :=
        broj_pokretanja_SelectSorta := 0;</pre
        >
        After that, all 5 variables will be 0. You can't do that in AEC for x86.
        In AEC for WebAssembly, assignment statements end with a semicolon
        <span class="inline_code">;</span> and can run across multiple lines. In
        AEC for x86, they end with a newline character. In AEC for x86, there is
        also the string-assignment operator
        <span class="inline_code">&lt;=</span> (similar to the difference
        between signal and variable assignments in VHDL). In AEC for
        WebAssembly, you use <span class="inline_code">:=</span> for string
        assignments.<br />
        <b>TODO</b>:
        <del
          >Implement the assignment operators
          <span class="inline_code">+=</span>,
          <span class="inline_code">-=</span> and related ones as they are in C,
          C++ and JavaScript. They can make code significantly shorter.</del
        >
        (<i>UPDATE on 14/09/2020: They have been implemented.</i>)<br />
        <br /><b id="Operators">Operators</b><br />
        AEC has the following operators:<br />
        <table>
          <tr>
            <th>Priority</th>
            <th>Associativity</th>
            <th>Operators</th>
          </tr>
          <tr>
            <td>1</td>
            <td>left</td>
            <td>. -&gt;</td>
          </tr>
          <tr>
            <td>2</td>
            <td>left</td>
            <td>* /</td>
          </tr>
          <tr>
            <td>3</td>
            <td>left</td>
            <td>- +</td>
          </tr>
          <tr>
            <td>4</td>
            <td>left</td>
            <td>&lt; &gt; =</td>
          </tr>
          <tr>
            <td>5</td>
            <td>left</td>
            <td>and (in the x86 dialect: &amp;)</td>
          </tr>
          <tr>
            <td>6</td>
            <td>left</td>
            <td>or (in the x86 dialect: |)</td>
          </tr>
          <tr>
            <td>7</td>
            <td>right</td>
            <td>?: (ternary conditional operator)</td>
          </tr>
          <tr>
            <td>8</td>
            <td>right</td>
            <td>:= (assignment operator)</td>
          </tr>
        </table>
        <i
          >(UPDATE on 07/10/2020: The operators
          <span class="inline_code">.</span> and
          <span class="inline_code">-&gt;</span> have the same meaning they do
          in C, dealing with structures and structure pointers.)</i
        >
        The first argument of the ternary conditional operator is converted to
        <span class="inline_code">Integer32</span> (that's how WebAssembly
        represents Booleans), and the last two are converted to strongest type
        of those two. The strongest types are pointers, next comes
        <span class="inline_code">Decimal64</span>, then
        <span class="inline_code">Decimal32</span>, then
        <span class="inline_code">Integer64</span>, then
        <span class="inline_code">Integer32</span>, then comes
        <span class="inline_code">Integer16</span>, while the weakest type is
        <span class="inline_code">Character</span>. Most binary operands convert
        both of their operands to the stronger type, except for the assignment
        operator, the <span class="inline_code">and</span> and
        <span class="inline_code">or</span> operator. The assignment operator
        converts the right-hand side operand to the type of the left-hand-side
        operand. In case one of them is a pointer and the other one isn't, the
        compiler issues a warning. The bitwise
        <span class="inline_code">and</span> and
        <span class="inline_code">or</span> convert both operands to
        <span class="inline_code">Integer32</span>. There are no logical
        <span class="inline_code">and</span> and
        <span class="inline_code">or</span> operators in AEC (like the C and C++
        <span class="inline_code">and</span> and
        <span class="inline_code">or</span> or
        <span class="inline_code">&amp;&amp;</span> and
        <span class="inline_code">||</span>). This can lead to some confusing
        behavior. For instance, <span class="inline_code">1 and 2</span> would
        be <span class="inline_code">1</span> in C and C++, but it's
        <span class="inline_code">0</span> in AEC. To convert a number to
        Boolean, you can use the built-in function
        <span class="inline_code">not(x)</span>, like this (from HybridSort):
        <pre>
        velicina_niza / (64 * 1024 / 4) +
        not(not(mod(velicina_niza, 64 * 1024 / 4))) &gt;
        prijasnja_velicina_niza / (64 * 1024 / 4) +
        not(not(mod(prijasnja_velicina_niza, 64 * 1024 / 4))) or
        prijasnja_velicina_niza = 0</pre
        >
        Namely, <span class="inline_code">not(not(x))</span> returns
        <span class="inline_code">1</span> if
        <span class="inline_code">x</span> is not
        <span class="inline_code">0</span>, and
        <span class="inline_code">0</span> if
        <span class="inline_code">x=0</span>. You can also use
        <span class="inline_code">not(x=0)</span>. There is no built-in
        <a href="https://en.wikipedia.org/wiki/Exclusive_or">exclusive or</a>
        function or operator in AEC, but you can easily build one like this
        (excerpt from
        <a href="arithmeticOperatorsTest.html">Arithmetic Operators Test</a>):
        <pre>
Function xor(Integer32 first,
             Integer32 second)
     Which Returns Integer32 Does
        //I hope people will like the way I named the bit-operators.
        Return (first and invertBits(second)) or (invertBits(first) and second);
EndFunction</pre
        >
        As you can see, there is a built-in
        <span class="inline_code">invertBits(Integer32 x)</span> function which
        inverts the bits in an integer. Internally, it
        <span class="inline_code">xor</span>-s
        <span class="inline_code">x</span> with
        <span class="inline_code">-1</span>.<br />
        <b>TODO</b>: Implement a less-than-or-equal-to operator
        <span class="inline_code">&lt;=</span> and a greater-than-or-equal-to
        operator <span class="inline_code">&gt;=</span>. For that, we will need
        to modify both the tokenizer, the parser and the compiler.<br />
        <br /><b id="Branching">Branching</b><br />
        Branching is supported only via <span class="inline_code">If</span>,
        <span class="inline_code">If</span>-<span class="inline_code">Else</span
        >, and <span class="inline_code">If</span>-<span class="inline_code"
          >ElseIf</span
        >-<span class="inline_code">Else</span>. There is no equivalent of C,
        C++ and JavaScript <span class="inline_code">switch</span>-<span
          class="inline_code"
          >case</span
        >. After the <span class="inline_code">If</span> token, the compiler
        expects a condition. In AEC for WebAssembly, the condition ends with a
        <span class="inline_code">Then</span>, while, in AEC for x86, the
        condition ends with a newline character. The branching ends with
        <span class="inline_code">EndIf</span>. That's to make the program
        easier to parse, and to prevent
        <a href="https://en.wikipedia.org/wiki/Dangling_else">dangling-else</a>.
        Between <span class="inline_code">Then</span> and
        <span class="inline_code">EndIf</span>, there can be an
        <span class="inline_code">Else</span> token. Before the
        <span class="inline_code">Else</span> token (if there is one, otherwise
        it's before the <span class="inline_code">EndIf</span>) there can be an
        <span class="inline_code">ElseIf</span> token. An
        <span class="inline_code">ElseIf</span> token, much like the
        <span class="inline_code">If</span> token, is followed by an expression
        representing a condition, which is ended by the
        <span class="inline_code">Then</span> token. After the
        <span class="inline_code">Then</span> token and after the
        <span class="inline_code">Else</span> token, you can put an
        <span class="inline_code">{</span> (curly brace) which the compiler will
        ignore. Similarly, you can put an
        <span class="inline_code">}</span> before
        <span class="inline_code">EndIf</span>,
        <span class="inline_code">ElseIf</span> and
        <span class="inline_code">Else</span>. That is to make it easier to use
        text editors made primarily for C like languages for writing AEC (to
        jump to the end of the code block, for example). An example from the
        Analog Clock in AEC:
        <pre>
        If signature[j] = '\n' Then
            i := (i / windowWidth + 1) * windowWidth;
        ElseIf not(signature[j] = 0) Then
            output[i] := signature[j];
            colors[i] :=   modraColor;
            i         :=        i + 1;
        Else
            output[i] := ' ';
        EndIf</pre
        >
        If there is an <span class="inline_code">ElseIf</span> token inside the
        <span class="inline_code">If</span>-statement, there, of course, doesn't
        need to be an <span class="inline_code">Else</span> token:
        <pre>
            If j &lt; 2 and (output[i - windowWidth] = 'x' and
                (output[i + 1] = 'x' or output[i - 1] = 'x')) Then
                output[i] :=            'x';
                colors[i] := darkGreenColor;
            ElseIf j=2 and (output[i + 1]=' ' and
                output[i - windowWidth] = 'x') Then
                output[i] := ' ';
            EndIf</pre
        >
        Note that, unlike in Ada or VHDL, there is no semicolon after the
        <span class="inline_code">EndIf</span> token.<br />
        Simple branching can also be done using the
        <span class="inline_code">?:</span> operator. As it is
        right-associative, it can be used to concisely write
        <span class="inline_code">ElseIf</span> statements. An example of that
        from Arithmetic Operators Test (one of the first programs I wrote in AEC
        for WebAssembly):
        <pre>
Function signum(Integer32 number) Which Returns Integer32 Does
    /* 
     * The ternary conditional operator "?:" is right-associative,
     * as it is in C, C++ and JavaScript (unlike in PHP), which
     * makes it easy to abbreviate else-if statements using it.
     * And, as of time of writing this, I haven't yet implemented
     * the "If" statement into the AEC-to-WebAssembly compiler.
     */
    Return (number&lt;0)? //If the number is less than 0...
                    -1 //signum of that number is -1...
                     : //else...
                     (number=0)? //if the number is 0...
                               0 //signum of that number is 0.
                               : //else...
                               1; //The signum of that number is 1.
EndFunction</pre
        >
        In AEC for x86, the condition after
        <span class="inline_code">ElseIf</span> ends with a newline, rather than
        with a <span class="inline_code">Then</span> token.<br />
        <b>TODO:</b> Implement something like
        <span class="inline_code">switch</span>-<span class="inline_code"
          >case</span
        >, to make it easier to write long
        <span class="inline_code">ElseIf</span> branchings. Most of the time,
        they are a sign of bad code design, but sometimes they are not, and it's
        not acceptable for a language to discourage them.<br />
        <br /><b id="Loops">Loops</b><br />
        For now, there is only one type of loop in AEC, the
        <span class="inline_code">While</span>-loop. A
        <span class="inline_code">While</span> token is followed by an
        expression representing a condition. That expression ends with a newline
        character in AEC for x86, and with a
        <span class="inline_code">Loop</span> token in AEC for WebAssembly. In
        both of them, the <span class="inline_code">While</span>-statement ends
        with an <span class="inline_code">EndWhile</span> token. For example,
        here is what the
        <a href="https://en.wikipedia.org/wiki/Euclidean_algorithm">
          Euclid Algorithm</a
        >
        looks like in AEC for WebAssembly (an excerpt from
        <a href="euclidTest.html">Euclid Test</a>):
        <pre>
    While not(b=0) Loop
        If a&gt;b Then
            a:=mod(a,b);
        Else
            If a=0 Then
                Return b;
            EndIf
            b:=mod(b,a);
        EndIf
    EndWhile</pre
        >
        It uses the built-in function
        <span class="inline_code">mod(Integer64 a, Integer64 b)</span> to get
        the remainder of the division. AEC for x86 supports it both for integers
        and decimal numbers, whereas AEC for WebAssembly supports it only for
        integers (for the simple reason that WebAssembly doesn't support it for
        decimal numbers either). Nevertheless, there is a simple way to write it
        yourself in AEC for WebAssembly (excerpt from the Analog Clock):
        <pre>
Function fmod(Decimal32 a, Decimal32 b) Which Returns Decimal32 Does
    Return a - b * Integer32(a / b);
EndFunction</pre
        >
        It might actually be a good idea to use
        <span class="inline_code">Integer64(</span> instead of
        <span class="inline_code">Integer32(</span>, because there is no
        guarantee that <span class="inline_code">a / b</span> will be in the
        range of <span class="inline_code">Integer32</span>. So, that's how you
        do casting in AEC, with the built-in functions named
        <span class="inline_code">DataType(</span>.<br />
        <b>TODO:</b> Think of some nice syntax for the
        <span class="inline_code">for</span>-loop, every remotely modern
        language has a <span class="inline_code">for</span>-loop. Also,
        implement something like C, C++ and JavaScript
        <span class="inline_code">break</span> and
        <span class="inline_code">continue</span>. Most of the time, they are a
        sign of bad code design, but sometimes they aren't, and it's not
        acceptable for a language to discourage them.<br />
        <br /><b id="Functions">Functions</b><br />
        AEC for x86 supports no user-added functions. Furthermore, the parser
        implemented there doesn't support functions with more than 2 arguments.
        AEC for WebAssembly supports functions, because WebAssembly makes it
        easy to implement them (x86 assembly doesn't have a standardized way to
        call functions, the way it's done varies by operating system). Importing
        functions from JavaScript is done like this (excerpt from Analog Clock):
        <pre>
//Let's import some functions useful for debugging from JavaScript...
Function logString(CharacterPointer str) Which Returns Nothing Is External;
Function logInteger(Integer32 int) Which Returns Nothing Is External;</pre
        >
        So, function declaration starts with a
        <span class="inline_code">Function</span> token. After it, comes a
        function name (ending with an open parenthesis
        <span class="inline_code">(</span>). After that, comes the list of
        arguments (it may be empty, and it often is). An element of that list
        consists of an argument type and an argument name. Unlike in C, argument
        name is obligatory and the parser is going to complain if you don't
        insert it. And there doesn't appear to be a simple way to change that.
        Arguments are separated by a colon token
        <span class="inline_code">,</span>. After that comes a
        <span class="inline_code">Which</span> token, after which comes a
        <span class="inline_code">Returns</span> token. Then comes a return type
        (which can be a data type or <span class="inline_code">Nothing</span>).
        If the function is being imported from JavaScript, then comes the
        <span class="inline_code">Is</span>-token,
        <span class="inline_code">External</span>-token and a semicolon. If the
        function is implemented in AEC, there comes the
        <span class="inline_code">Does</span>-token, then comes the function
        body which ends with the <span class="inline_code">EndFunction</span>
        token. A function exits when the control flow reaches the
        <span class="inline_code">EndFunction</span>-token or when it reaches a
        <span class="inline_code">Return</span>-statement. If the function
        returns <span class="inline_code">Nothing</span>, a
        <span class="inline_code">Return</span>-statement consists only of a
        <span class="inline_code">Return</span>-token and a semicolon. If a
        function returns something, there needs to be an expression between a
        <span class="inline_code">Return</span>-token and a semicolon, the
        result of which the function will return to its caller. If the control
        flow of a function that returns something reaches the
        <span class="inline_code">EndFunction</span>-token, the function returns
        0 (in sharp contrast with both C-like languages, where such a function
        returns an undefined value, and Rust, where such a function returns a
        value of last expression in it). There have been a few examples of
        functions in this specification. Arguments to functions may have default
        values, specified as follows (excerpt from Empty Function Test):
        <pre>
Function empty_function(Character charArgument:='A',
                        Integer16 shortArgument:=4096,
                        Integer32 intArgument:=32768,
                        Integer64 longArgument:=8*exp(9*log(10)),
                        Decimal32 floatArgument:=22/7,
                        Decimal64 doubleArgument:=pi)
         Which Returns Nothing Does
    //It does nothing, but the compiler should still generate valid code.
EndFunction</pre
        >
        Now, if you call such a function with fewer than 6 arguments, the
        compiler will not complain, but will supply the rest with default
        values. Note that this will not work when calling an AEC function from
        JavaScript.
        <del
          >AEC doesn't support function hoisting nor circularly dependent
          functions, for the simple reason that there is no obvious way to
          implement them in WebAssembly.</del
        >
        <i
          >(UPDATE: C++-style forward function declarations have been
          implemented, as there is a relatively simple way to do it using
          WebAssembly Binary Toolkit, the assembler takes care of that for you.
          The syntax is the same as for declaring external functions, except
          that you replace <span class="inline_code">External</span> with
          <span class="inline_code">Declared</span>.)</i
        ><br />
        <b>TODO</b>: Find a way to implement circularly dependent functions,
        and, if possible, function hoisting. Also, implement function pointers.
        Named function arguments (using, for example, the
        <span class="inline_code">:=</span> operator) might also come useful (in
        languages with them, there is basically no need for the abstract
        builders and directors).<br />
        <br /><b id="Structures">Structures</b><br />
        The parser can parse structure declarations of the form:
        <pre>
Structure Point Consists Of
    Decimal32 x,y,z;
    Integer16 number_of_dimensions;
EndStructure</pre
        >
        However, the compiler crashes if you insert them in a real program
        (rather than just in a parser test). Structures are supposed to be
        instantiated using a directive called
        <span class="inline_code">InstantiateStructure</span>, that is, an
        <span class="inline_code">InstantiateStructure</span> token followed by
        the structure name followed by the variable name (and the variable will
        be of type represented by the structure name).<br />
        <b>TODO</b>: Implement structures in the compiler, not just in the
        parser.
        <i
          >(UPDATE on 30/09/2020: Some progress on that has been made, namely,
          local and global structures are now supported
          <del>as long as they are not nested</del>. You can see an example
          program using them
          <a href="structureDeclarationTest.aec.html">here</a>. Structures as
          arguments or return types aren't supported for now, and are unlikely
          to be so in the near future. I've started a
          <a
            href="https://www.reddit.com/r/WebAssembly/comments/j24p4z/how_to_compile_returning_a_structure_from_a/?utm_source=share&utm_medium=web2x&context=3"
          >
            Reddit thread
          </a>
          asking for help with that.<br />
          UPDATE on 16/02/2021: My implementation of the
          <a href="nQueensPuzzle.html">N-Queens Puzzle</a> in AEC uses
          structures.<br />
          UPDATE on 28/04/2021: I have started a
          <a href="https://www.forum.hr/showthread.php?t=1243515"
            >forum thread</a
          >
          to help me with implementing structures as arguments to the
          functions.)</i
        ><br />
        <br /><b id="Assembly">Inline assembly</b><br />
        AEC for x86 passes everything between the
        <span class="inline_code">AsmStart</span> and
        <span class="inline_code">AsmEnd</span> token unchanged to the
        assembler. AEC for WebAssembly has keywords
        <span class="inline_code">asm(</span>,
        <span class="inline_code">asm_i32(</span>,
        <span class="inline_code">asm_i64(</span>,
        <span class="inline_code">asm_f32(</span> and
        <span class="inline_code">asm_f64(</span> which expect a compile-time
        constant string as an argument which the compiler will process (for
        example, replace <span class="inline_code">\n</span> with a literal
        new-line character and <span class="inline_code">\\</span> with
        <span class="inline_code">\</span>...) and pass it to the assembler.
        <span class="inline_code">asm(</span> assumes that nothing will be left
        on the system stack by the inline assembly code, while other ones assume
        that a certain WebAssembly type (corresponding to some AEC type) will be
        left on the system stack by it, which they will then fetch. Since
        WebAssembly type <span class="inline_code">i32</span> corresponds to AEC
        <span class="inline_code">Integer32</span> and pointers, we can write
        something like this (excerpt from HybridSort):
        <pre>
//Napravimo sada omotnicu oko WebAssemblerske naredbe "memory.grow"...
Function zauzmi_memorijske_stranice(Integer32 broj_stranica) Which Returns
    CharacterPointer Does
    Integer32 nova_adresa_u_stranicama :=
        asm_i32 //"asm_i32" ka&#382;e compileru da umetne asemblerski kod, i da
                //pretpostavi da &#263;e se nakon njega na sistemskom stogu
                //nalaziti vrijednost tipa "i32". To o&#269;ito nije to&#269;no ako
                //netko prebaci JavaScript virtualnu ma&#353;inu u 64-bitni
                //na&#269;in rada, ali nadam se da to nitko ne&#263;e napraviti.
                //Vjerojatnost da &#263;e JavaScript virtualnoj ma&#353;ini trebati
                //vi&#353;e nego 4GB RAM-a je zanemariva, a vjerojatnost da &#263;e
                //se neki korisni programi sru&#353;iti zbog prebacivanja u 
                //64-bitni na&#269;in rada nije ba&#353; zanemariva.
                ("(memory.grow\n"
                "\t(local.get 0)\n" //Prvi (nulti) argument funkcije,
                                    //"brojStranica".
                ")\n");
    If nova_adresa_u_stranicama = -1 Then //Ako nema vi&#353;e
                                          //slobodne memorije...
        Return -1;
    EndIf
    Return nova_adresa_u_stranicama * 64 * 1024; //Na JavaScript Virtualnoj
                                                 //Ma&#353;ini, jedna stranica
                                                 //(page) iznosi 64 KB.
EndFunction</pre
        >
        Remember that string tokens put next to each other are concatenated by
        the tokenizer into one string token.<br />
        <b>TODO</b>: Implement a GCC-and-CLANG-style inline assembly, where you
        can access variables from assembly by their names (rather than having to
        manually calculate their memory addresses).<br />
        <br /><b id="Builtin">Built-in functions</b><br />
        AEC for x86 has many built-in functions, wrappers around x86 assembly
        instructions. These are: <span class="inline_code">sin(</span>,
        <span class="inline_code">cos(</span>,
        <span class="inline_code">tan(</span>,
        <span class="inline_code">atan2(</span>,
        <span class="inline_code">arctan(</span>,
        <span class="inline_code">ctg(</span>,
        <span class="inline_code">arcctg(</span>,
        <span class="inline_code">sqrt(</span>,
        <span class="inline_code">arcsin(</span>,
        <span class="inline_code">arccos(</span>,
        <span class="inline_code">ln(</span> (natural logarithm),
        <span class="inline_code">log(</span> (base-10 logarithm),
        <span class="inline_code">exp(</span> (returns the Euler number to the
        power of the argument), <span class="inline_code">pow(</span>,
        <span class="inline_code">abs(</span> and
        <span class="inline_code">mod(</span> (floating-point modulo). Unlike in
        most programming languages, trigonometric functions expect arguments in
        degrees (not radians, as in C, C++ or JavaScript). Similarly, the
        cyclometric functions such as <span class="inline_code">atan2(</span>
        return the result in degrees, rather than in radians. If you want to use
        them in AEC for WebAssembly, you can write them yourself, like this
        (excerpt from the Analog Clock):
        <pre>
Function sin(Decimal32 degrees) Which Returns Decimal32 Does
    If degrees&lt;0 Then
        Return -sin(-degrees);
    EndIf
    If degrees&gt;90 Then
        Decimal32 sinOfDegreesMinus90 := sin(degrees - 90);
        If fmod(degrees, 360) &lt; 180 Then
            Return sqrt(1 - sinOfDegreesMinus90 * sinOfDegreesMinus90);
        Else
            Return -sqrt(1 - sinOfDegreesMinus90 * sinOfDegreesMinus90);
        EndIf
    EndIf
    /* 
     * Sine and cosine are defined in Mathematics 2 using the system of
     * equations (Cauchy system):
     * 
     * sin(0)=0
     * cos(0)=1
     * sin'(x)=cos(x)
     * cos'(x)=-sin(x)
     * ---------------
     *
     * Let's translate that as literally as possible to the programming
     * language.
     */
    Decimal32 radians := degrees / oneRadianInDegrees,
              tmpsin  := 0,
              tmpcos  := 1,
              epsilon := radians / PRECISION,
              i       := 0;
    While (epsilon&gt;0 and i&lt;radians) or (epsilon&lt;0 and i&gt;radians) Loop
        tmpsin := tmpsin + epsilon * tmpcos;
        tmpcos := tmpcos - epsilon * tmpsin;
        i      :=               i + epsilon;
    EndWhile
    Return tmpsin;
EndFunction</pre
        >
        Or, you may use the Taylor Series. But I think this obeys the KISS (keep
        it simple, stupid) principle better. Note that you can't call the
        JavaScript <span class="inline_code">Math.sin</span> and similar
        functions, because they are methods of the
        <span class="inline_code">Math</span> singleton, and there is no
        standardized way to call methods of JavaScript objects from WebAssembly
        (for a good reason).<br />
        <b>TODO</b>: Build some mathematical functions into AEC for
        WebAssembly.<br />
        <br /><b id="String">String manipulation</b><br />
        AEC for x86 doesn't support string manipulation at all, it doesn't have
        a character type. AEC for WebAssembly is about as good at C manipulation
        as C is without a C library (like when doing operating system
        development). There are no built-in string-manipulation functions, but
        one can easily write them oneself, like this (excerpt from
        <a href="dragonCurve.html">Dragon Curve</a>):
        <pre>
//Again, we need to implement string manipulation functions. Like I've said,
//even though this program will be running on JavaScript Virtual Machine, it
//can't call the methods of the JavaScript "String" class.
Function strlen(CharacterPointer str) Which Returns Integer32 Does
    //We can't implement this recursively, like we did in earlier AEC
    //programs, because we will be dealing with large strings which will
    //cause stack overflow.
    Integer32 length := 0;
    While ValueAt(str + length) Loop
        length := length + 1;
    EndWhile
    Return length;
EndFunction

Function strcpy(CharacterPointer dest,
                CharacterPointer src) Which Returns Nothing Does
    While ValueAt(src) Loop
        ValueAt(dest) := ValueAt(src);
        dest          :=     dest + 1;
        src           :=      src + 1;
    EndWhile
    ValueAt(dest) := 0;
EndFunction

Function reverseString(CharacterPointer string) Which Returns Nothing Does
    CharacterPointer pointerToLastCharacter := string + strlen(string) - 1;
    While pointerToLastCharacter - string &gt; 0 Loop
        Character tmp                   := ValueAt(string);
        ValueAt(string)                 := ValueAt(pointerToLastCharacter);
        ValueAt(pointerToLastCharacter) := tmp;
        string                          := string + 1;
        pointerToLastCharacter          := pointerToLastCharacter - 1;
    EndWhile
EndFunction

Function strcat(CharacterPointer dest,
                CharacterPointer src) Which Returns Nothing Does
    strcpy(dest + strlen(dest), src);
EndFunction

Function convertIntegerToString(CharacterPointer string,
                                Integer32 number)
    Which Returns Integer32 Does //Returns the length of the string.
    Integer32 isNumberNegative := 0;
    If number &lt; 0 Then
        number           := -number;
        isNumberNegative :=       1;
    EndIf
    Integer32 i := 0;
    While number &gt; 9 Loop
        ValueAt(string + i) := '0' + mod(number, 10);
        number              :=           number / 10;
        i                   :=                 i + 1;
    EndWhile
    ValueAt(string + i) := '0' + number;
    i                   :=        i + 1;
    If isNumberNegative Then
        ValueAt(string + i) :=   '-';
        i                   := i + 1;
    EndIf
    ValueAt(string + i) := 0;
    reverseString(string);
    Return i;
EndFunction</pre
        >
        To delete a character from a string, you can use the following function
        from the
        <a
          href="https://github.com/FlatAssembler/AECforWebAssembly/tree/master/HavlikLaw"
          >Havlik's Law</a
        >:
        <pre>
Function izbrisi_znak_iz_stringa(CharacterPointer mjesto_u_stringu)
         Which Returns Nothing Does
               While ValueAt(mjesto_u_stringu) Loop
                     ValueAt(mjesto_u_stringu) :=
                                               ValueAt(
                                                mjesto_u_stringu + 1
                                                );
                     mjesto_u_stringu += 1;
               EndWhile
EndFunction
	  </pre
        >
        <b>TODO</b>: Build some useful string manipulation into AEC, at least
        ones for converting numbers to strings and vice versa.<br />
        <br /><b id="AdvancedArray">Advanced array manipulation</b><br />
        When it comes to sorting arrays, I've tried to efficiently implement the
        <a href="HybridSort.aec.html">HybridSort</a> (a sorting algorithm I came
        up with, a mixture of MergeSort, QuickSort and SelectionSort) algorithm
        in AEC. HybridSort sorting algorithm is based on the fact that the
        number of comparisons done by MergeSort depends only on the size of the
        array, and is always equal to
        <div class="formula">2&middot;n&middot;log<sub>2</sub>(n)</div>
        , where <i>n</i> is the length of the array, while QuickSort is faster
        more shuffled the array is and is slowest for already-sorted and
        inverse-sorted arrays. So, sometimes QuickSort is faster, and sometimes
        MergeSort is faster. Using a simple
        <a
          href="https://github.com/FlatAssembler/ArithmeticExpressionCompiler/tree/master/QuickSort/Genetic_algorithm_for_deriving_the_formula"
          >genetic algorithm</a
        >, I came up with a formula for approximating how many comparisons
        QuickSort will do on a given array. That formula is:
        <div class="formula">
          e<sup
            >(ln(n) + ln(ln(n))) &middot; 1.05 + (ln(n) - ln(ln(n)) - ln(2))
            &middot; 0.9163 &middot; |2.38854 &middot; s<sup>7</sup> - 0.284258
            &middot; s<sup>6</sup> - 1.87104 &middot; s<sup>5</sup> + 0.372637
            &middot; s<sup>4</sup> + 0.167242 &middot; s<sup>3</sup> - 0.0884977
            &middot; s<sup>2</sup> + 0.315119 &middot; s|</sup
          >
        </div>
        , where <i>s</i> is the sortedness of the array (-1 when the array is
        inverse-sorted, 1 when it is sorted, around 0 when it is randomly
        shuffled), and <i>ln</i> being the natural logarithm, base
        <i>e = 2.718...</i>. I am not sure how to test how correct that
        approximation is. My algorithm is recursive, and for every iteration of
        the recursion, it estimates whether it should behave like QuickSort or
        like MergeSort based on those formulas. In case the array is very small,
        so that SelectionSort is faster than both QuickSort and MergeSort, or in
        case it runs of stack memory, it runs SelectionSort. However, for some
        reason, my algorithm is significantly slower than JavaScript
        <span class="inline_code">Array.sort</span> method:<br /><br />
        <img
          src="https://github.com/FlatAssembler/AECforWebAssembly/raw/master/HybridSort/rezultati_mjerenja.jpg"
          style="
            max-width: 100%;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 10px;
            display: block;
          "
          alt="Results of the measurements"
        />
        I am not sure what causes those <i>stairs</i> in the measurement
        results. Professor Alfonzo Baumgartner thinks it has to do with cache
        misses, here is what he wrote when I asked him about that in an e-mail:
        <div class="quotation" lang="hr">
          Po&#353;tovani,<br />
          obja&#353;njenje koje ja nudim za te 'stepenice' je u &#269;injenici
          da svi procesori koriste cache memoriju u koje spremaju odre&#273;eni
          broj memorijskih stranica.<br />
          Ako uzmemo da je jedna memorijska stranica npr. 64K, onda, &#269;im se
          na&#353; niz pove&#263;a samo za 1 element vi&#353;e od 64K, potrebne
          su dvije memorijske stranice. &#268;im se na&#353; niz prostire na
          dvije memorijske stranice, odmah je mogu&#263;nost tzv. 'cache
          miss'-ova kada procesor ne&#263;e prona&#263;i u svome L1 cache-u tu
          stranicu pa mora do&#263;i do zamjene stranica unutar cache, &#353;to
          usporava izvo&#273;enje programa.<br />

          Kako Vi pove&#263;avate niz, tako se koristi sve vi&#353;e memorijskih
          stranica u kojima je on zapisan, a sam cache-ing sistem onda ima
          vi&#353;e posla oko njihovih zamjena.
          <br />
          Zato se za neke duljine nizova dobiva skoro isti rezultat, a onda
          &#269;im pove&#263;amo samo za jedan podatak (koji ide u novu mem.
          stranicu) dobijemo 'drasti&#269;no' uve&#263;an rezultat mjerenja.
          <br />
          Ne znam jeste li me shvatili i nisam siguran 100% da je to kod Vas
          uzrok tih 'stepenica', ali na prvi pogled mi se &#269;ini takvo
          ne&#353;to..
          <br />
          Alfonzo.
        </div>
        In any case, I think this is an interesting result worth of further
        exploration. Which sorting algorithms have those <i>stairs</i> when
        measured? Why do some do, and some (like JavaScript
        <span class="inline_code">Array.sort</span>) do not, on the same array?
        <br />
        <br /><b id="Conclusion">Conclusion</b><br />
        I think AEC is a promising project, but a lot of work is still needed to
        make it successful. I don't think I can do everything that's needed for
        it to be successful by myself.
        <br /><br />
        <b>UPDATE</b> on 16/10/2020: I've published a
        <a href="https://youtu.be/YFZ-45ea5mo">YouTube video</a>
        about programming in your programming languages for the client-side web.
        If you have trouble playing it, you can download the
        <a href="AECforWebAssembly.mp4">minified MP4</a> and try opening it in
        VLC or a similar program. If nothing else works, try opening the
        <a href="AECforWebAssembly.zip">ZIP file</a> with a PDF, an ODP and a
        PPT file.
      </div>
      <script type="text/javascript">
        function highlightedToken(token) {
          if (token == "<") token = "&lt;";
          if (token == ">") token = "&gt;";
          if (token.substr(0, 2) == "//" || token.substr(0, 2) == "/*")
            return '<span class="Comment">' + token + "</span>";
          if (token.charAt(0) == '"' || token.charAt(0) == "'")
            return (
              '<span class="String">' +
              token
                .replace(/\\n/g, "<b>\\<i>n</i></b>")
                .replace(/\\t/g, "<b>\\<i>t</i></b>") +
              "</span>"
            );
          if (
            token == "Character" ||
            token == "CharacterPointer" ||
            token == "Integer16" ||
            token == "Integer16Pointer" ||
            token == "Integer32" ||
            token == "Integer32Pointer" ||
            token == "Integer64" ||
            token == "Integer64Pointer" ||
            token == "Decimal32" ||
            token == "Decimal64" ||
            token == "Decimal32Pointer" ||
            token == "Decimal64Pointer" ||
            token == "DataType" ||
            token == "Nothing"
          )
            return '<span class="Type">' + token + "</span>";
          if (token.charAt(0) >= "0" && token.charAt(0) <= "9")
            return '<span class="Constant">' + token + "</span>";
          if (
            token == "Function" ||
            token == "Which" ||
            token == "Returns" ||
            token == "Is" ||
            token == "External" ||
            token == "Does" ||
            token == "EndFunction" ||
            token == "Return" ||
            token == "If" ||
            token == "ElseIf" ||
            token == "Else" ||
            token == "EndIf" ||
            token == "Then" ||
            token == "While" ||
            token == "EndWhile" ||
            token == "Loop" ||
            token == ";" ||
            token == "Structure" ||
            token == "Consists" ||
            token == "Of" ||
            token == "EndStructure" ||
            token == "asm" ||
            token == "asm_i32" ||
            token == "asm_i64" ||
            token == "asm_f32" ||
            token == "asm_f64"
          )
            return '<span class="Keyword">' + token + "</span>";
          if (
            token == "and" ||
            token == "or" ||
            token == "mod" ||
            token == "AddressOf" ||
            token == "ValueAt" ||
            token == "," ||
            token == "+" ||
            token == "-" ||
            token == "/" ||
            token == "*" ||
            token == "?" ||
            token == ":" ||
            token == "=" ||
            token == "&lt;" ||
            token == "&gt;" ||
            token == "not" ||
            token == "invertBits"
          )
            return '<span class="Operator">' + token + "</span>";
          if (
            token == "{" ||
            token == "}" ||
            token == "(" ||
            token == ")" ||
            token == "[" ||
            token == "]"
          )
            return '<span class="Parenthesis">' + token + "</span>";
          return token;
        }
        function highlightAEC(sourceCode) {
          var currentToken = "",
            areWeInAString = false,
            areWeInAComment = false,
            howTheCommentStarted,
            howTheStringStarted,
            highlightedCode = "";
          for (var i = 0; i < sourceCode.length; i++) {
            if (
              !areWeInAComment &&
              !areWeInAString &&
              (sourceCode.substr(i, 2) == "//" ||
                sourceCode.substr(i, 2) == "/*")
            ) {
              areWeInAComment = true;
              howTheCommentStarted = sourceCode.substr(i, 2);
              highlightedCode += highlightedToken(currentToken);
              currentToken = howTheCommentStarted;
              i++;
              continue;
            }
            if (
              areWeInAComment &&
              ((howTheCommentStarted == "//" && sourceCode.charAt(i) == "\n") ||
                (howTheCommentStarted == "/*" &&
                  sourceCode.substr(i, 2) == "*/"))
            ) {
              areWeInAComment = false;
              if (howTheCommentStarted == "//") currentToken += "\n";
              else currentToken += "*/";
              if (howTheCommentStarted == "/*") i++;
              highlightedCode += highlightedToken(currentToken);
              currentToken = "";
              continue;
            }
            if (areWeInAComment) {
              currentToken += sourceCode.charAt(i);
              continue;
            }
            if (
              !areWeInAString &&
              (sourceCode.charAt(i) == '"' || sourceCode.charAt(i) == "'")
            ) {
              areWeInAString = true;
              howTheStringStarted = sourceCode.charAt(i);
              highlightedCode += highlightedToken(currentToken);
              currentToken = sourceCode.charAt(i);
              continue;
            }
            if (
              areWeInAString &&
              currentToken.charAt(currentToken.length - 1) != "\\" &&
              sourceCode.charAt(i) == howTheStringStarted
            ) {
              areWeInAString = false;
              currentToken += sourceCode.charAt(i);
              highlightedCode += highlightedToken(currentToken);
              currentToken = "";
              continue;
            }
            if (areWeInAString) {
              currentToken += sourceCode.charAt(i);
              continue;
            }
            if (
              (sourceCode.charAt(i) >= "0" && sourceCode.charAt(i) <= "9") ||
              (sourceCode.charAt(i) >= "a" && sourceCode.charAt(i) <= "z") ||
              (sourceCode.charAt(i) >= "A" && sourceCode.charAt(i) <= "Z") ||
              sourceCode.charAt(i) == "_" ||
              sourceCode.charAt(i) == "."
            ) {
              currentToken += sourceCode.charAt(i);
              continue;
            }
            highlightedCode +=
              highlightedToken(currentToken) +
              highlightedToken(sourceCode.charAt(i));
            currentToken = "";
          }
          return highlightedCode + highlightedToken(currentToken);
        }
        var preTags = document.getElementsByTagName("pre");
        for (var i = 0; i < preTags.length; i++)
          if (!/LinuxShell/.test(preTags[i].className))
            preTags[i].innerHTML = highlightAEC(preTags[i].innerText).replace(
              /\n/g,
              navigator.appName === "Microsoft Internet Explorer"
                ? "<br/>"
                : "\n"
            );
      </script>
    </main>
    <footer>
      <div
        style="
          width: 25%;
          float: right;
          text-align: left;
          bottom: 30px;
          background: #aaffaa;
        "
      >
        Choose the style:
        <a
          href="#"
          style="color: red"
          onclick="document.getElementById('glavni').setAttribute('class', 'main1')"
          >[1]</a
        >
        <a
          href="#"
          style="color: red"
          onclick="document.getElementById('glavni').setAttribute('class', 'main2')"
          >[2]</a
        >
        <a
          href="#"
          style="color: red"
          onclick="document.getElementById('glavni').setAttribute('class', 'main3')"
          >[3]</a
        >
      </div>
      <div style="background: #aaffaa; float: right; width: 50%">
        Uploaded by Teo Samarzija on 29/08/2020
      </div>
      <svg
        id="donjiLijevi"
        style="float: left; width: 25%; height: 100%; overflow: hidden"
      ></svg>
      <script type="text/javascript">
        if (navigator.appName == "Microsoft Internet Explorer") {
          var niz = document.getElementsByTagName("div");
          for (var i = 0; i < niz.length; i++) {
            if (niz[i].className.indexOf("link1") == -1) continue;
            niz[i].onmouseenter = function () {
              this.children[0].style.display = "inline";
            };
            niz[i].onmouseleave = function () {
              this.children[0].style.display = "none";
            };
          }
          document.getElementById("glavni").removeAttribute("style");
        } else if (navigator.appName == "Opera") {
          document.getElementById("glavni").style.color = "black";
          document.getElementById("glavni").style.backgroundColor = "white";
          var gornjiDesni = document.getElementById("gornjiDesni");
          gornjiDesni.parentNode.removeChild(gornjiDesni);
        } else if (
          (((navigator.userAgent.indexOf("Safari") + 1 ||
            navigator.userAgent.indexOf("WebKit") + 1) &&
            navigator.userAgent.indexOf("Mobile") + 1 &&
            (!(navigator.userAgent.indexOf("Chrome") + 1) ||
              (navigator.userAgent.indexOf("Version") + 1 &&
                navigator.userAgent.indexOf("Chrome") + 1))) ||
            (navigator.userAgent.indexOf("Mobile") + 1 &&
              navigator.userAgent.indexOf("Gecko") + 1 &&
              !(navigator.userAgent.indexOf("like Gecko") + 1) &&
              !(navigator.userAgent.indexOf("Dolfin") + 1))) &&
          !(navigator.userAgent.indexOf("iPad") + 1) &&
          !(navigator.userAgent.indexOf("iPhone") + 1)
        )
          document.getElementById("glavni").style.fontSize = "36px";
        else if (navigator.userAgent.indexOf("Mobi") + 1) {
          document.head.innerHTML +=
            '<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">';
          var niz = document.getElementsByTagName("svg");
          for (var i = 0; i < niz.length; i++) niz[i].style.display = "none";
          document.getElementsByTagName("aside")[0].style.display = "none";
          document.getElementsByTagName("aside")[0].style.float = "none";
          document.getElementsByTagName("aside")[0].style.width = "100%";
          document.getElementsByTagName("aside")[0].style.height = "auto";
          document.getElementsByTagName("aside")[0].style.WebkitAnimationName =
            "none";
          niz = document.getElementsByClassName("popup");
          for (var i = 0; i < niz.length; i++) {
            niz[i].style.width = "50%";
            niz[i].style.left = "45%";
            niz[i].style.maxWidth = "none";
          }
          document.getElementsByTagName("section")[0].style.height = "auto";
          document.getElementsByTagName("section")[0].style.float = "none";
          document.getElementsByTagName("section")[0].style.width = "100%";
          document.getElementsByTagName("header")[0].style.height = "auto";
          document.getElementById("naslov").style.height = "auto";
          document.getElementById("titleContainer").style.transform = "";
          document.getElementsByTagName("header")[0].style.lineHeight =
            "normal";
          document.getElementsByTagName("main")[0].style.width = "100%";
          document.getElementsByTagName("footer")[0].children[0].style.display =
            "inline";
          document.getElementsByTagName("footer")[0].children[0].style.float =
            "none";
          document.getElementsByTagName("footer")[0].children[0].innerHTML +=
            "<br/><br/>";
          document.getElementsByTagName("footer")[0].style.height = "auto";
          document.getElementsByTagName("footer")[0].style.lineHeight =
            "normal";
          document.getElementsByTagName("header")[0].outerHTML +=
            '<button id="showNavigation" style="width:100%;line-height:36px;height:41px;">Show navigation<\/button>';
          document.getElementById("showNavigation").onclick = function () {
            if (
              document.getElementsByTagName("aside")[0].style.display == "none"
            ) {
              this.innerHTML = "Hide navigation";
              document.getElementsByTagName("aside")[0].style.display = "block";
            } else {
              this.innerHTML = "Show navigation";
              document.getElementsByTagName("aside")[0].style.display = "none";
            }
          };
          //                           window.setTimeout(function(){document.body.removeChild(document.body.children[document.body.children.length-1]);},2000);
          document.getElementById("naslov").style.width = "100%";
          document.getElementById("naslov").style.float = "none";
          document.getElementsByTagName("header")[0].style.backgroundColor =
            document.getElementById("naslov").style.backgroundColor;
          document.getElementsByTagName("footer")[0].children[1].style.display =
            "inline";
          document.getElementsByTagName("footer")[0].children[1].style.width =
            "100%";
          document.getElementsByTagName("footer")[0].children[1].style.float =
            "none";
          document.getElementsByTagName("footer")[0].style.backgroundColor =
            document.getElementsByTagName(
              "footer"
            )[0].children[0].style.backgroundColor;
        }
        function footerScript() {
          var crtanje = document.getElementById("donjiLijevi");
          while (crtanje.childNodes.length)
            crtanje.removeChild(crtanje.childNodes[0]);
          var visina = crtanje.clientHeight;
          var sirina = crtanje.clientWidth;
          if (!visina || !sirina) {
            visina = crtanje.parentNode.clientHeight;
            sirina = crtanje.parentNode.clientWidth / 4;
          }
          var elipsa = document.createElementNS(svgNS, "ellipse");
          elipsa.setAttribute("cx", sirina);
          elipsa.setAttribute("cy", 0);
          elipsa.setAttribute("rx", sirina);
          elipsa.setAttribute("ry", visina);
          elipsa.setAttribute("fill", "#aaffaa");
          crtanje.appendChild(elipsa);
          for (var i = 0; i < 30; i++) {
            var kut1 = (270 + i * 3) / 57.3;
            var kut2 = (274 + i * 3) / 57.3;
            var x1 = Math.round(sirina - Math.cos(kut1) * sirina);
            var x2 = Math.round(sirina - Math.cos(kut2) * sirina);
            var y1 = -Math.round(Math.sin(kut1) * visina);
            var y2 = -Math.round(Math.sin(kut2) * visina);
            var trokut = document.createElementNS(svgNS, "polygon");
            trokut.setAttribute(
              "points",
              x1 + "," + y1 + " " + x2 + "," + y2 + " " + sirina + ",0"
            );
            trokut.setAttribute(
              "fill",
              "rgb(170," +
                Math.round(255 - i * 2.83) +
                "," +
                Math.min(Math.round(170 + i * 4), 255) +
                ")"
            );
            crtanje.appendChild(trokut);
          }
        }
        footerScript();
        window.addEventListener("resize", footerScript);
      </script>
    </footer>
  </body>
</html>
